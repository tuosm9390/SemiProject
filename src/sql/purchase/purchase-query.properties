selectStartDay=SELECT TO_CHAR(CLS_START, 'YYYY-MM') DAY FROM (SELECT CLS_START, SYSDATE - CLS_START FROM CLASS ORDER BY 2 DESC) WHERE ROWNUM = 1
selectPurchaseList=SELECT P.PAY_NO, P.USER_NO, P.CLS_NO, P.PAY_STATUS, P.NOTIFY_DATE, P.PAY_MEMO, P.PAY_MONEY, P.RECIPT_DATE, P.REFUND_DAY, C.CLS_NAME, C.TUITION, C.CLS_START, C.CLS_END, C.CLS_CNT, M.USER_ID, M.NAME, R.RFD_DATE,  NVL(R.RFD_RATE, 0) RFD_RATE, H.BEN_CONTENT, NVL(B.BEN_RATE, 0) BEN_RATE, NVL(R.FAULT_DAYS, 0) FAULT_DAYS FROM PURCHASE P LEFT JOIN MEMBER M ON (P.USER_NO = M.USER_NO) LEFT JOIN CLASS C ON (P.CLS_NO = C.CLS_NO) LEFT JOIN REFUND R ON (P.RFD_ID = R.RFD_ID) LEFT JOIN BEN_HISTORY H ON (P.BEN_HIS_NO = H.BEN_HIS_NO) LEFT JOIN BENEFIT B ON (H.BEN_NO = B.BEN_NO) WHERE C.CLS_START <= ADD_MONTHS(TO_DATE(?, 'YYYY-MM'), 1) AND C.CLS_END >= TO_DATE(?, 'YYYY-MM') AND (P.RFD_ID <> 'C1' OR P.RFD_ID IS NULL) AND EXTRACT(YEAR FROM NOTIFY_DATE) = EXTRACT(YEAR FROM TO_DATE(?, 'YYYY-MM')) AND EXTRACT(MONTH FROM NOTIFY_DATE) = EXTRACT(MONTH FROM TO_DATE(?, 'YYYY-MM'))
selectClass=SELECT DISTINCT P.CLS_NO, C.CLS_NAME FROM PURCHASE P LEFT JOIN CLASS C ON (P.CLS_NO = C.CLS_NO) WHERE C.CLS_START <= ADD_MONTHS(TO_DATE(?, 'YYYY-MM'), 1) AND C.CLS_END >= TO_DATE(?, 'YYYY-MM')
updateStatus=UPDATE PURCHASE SET PAY_STATUS = 'Y', PAY_WAY = 'ETC', PAYMENT_DAY = SYSDATE, PAY_MONEY = ? WHERE PAY_NO = ? AND PAY_STATUS = 'N'
updateBill=UPDATE PURCHASE SET NOTIFY_DATE = SYSDATE WHERE PAY_NO = ? AND NOTIFY_DATE IS NULL
updateRecipt=UPDATE PURCHASE SET RECIPT_DATE = SYSDATE WHERE PAY_NO = ? AND RECIPT_DATE IS NULL AND PAY_STATUS = 'Y'
selectPurchaseDetail=SELECT P.PAY_NO, P.USER_NO, P.CLS_NO, P.PAY_STATUS, P.NOTIFY_DATE, P.PAY_MEMO, P.PAY_MONEY, P.RECIPT_DATE, P.REFUND_DAY, C.CLS_NAME, C.TUITION, C.CLS_START, C.CLS_END, C.CLS_CNT, M.USER_ID, M.NAME, R.RFD_DATE,  NVL(R.RFD_RATE, 0) RFD_RATE, H.BEN_CONTENT, NVL(B.BEN_RATE, 0) BEN_RATE, NVL(R.FAULT_DAYS, 0) FAULT_DAYS FROM PURCHASE P LEFT JOIN MEMBER M ON (P.USER_NO = M.USER_NO) LEFT JOIN CLASS C ON (P.CLS_NO = C.CLS_NO) LEFT JOIN REFUND R ON (P.RFD_ID = R.RFD_ID) LEFT JOIN BEN_HISTORY H ON (P.BEN_HIS_NO = H.BEN_HIS_NO) LEFT JOIN BENEFIT B ON (H.BEN_NO = B.BEN_NO) WHERE PAY_NO = ?